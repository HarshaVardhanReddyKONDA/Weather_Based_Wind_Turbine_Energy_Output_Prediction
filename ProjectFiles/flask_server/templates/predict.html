<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WindForce - Predict</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Chakra+Petch:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    :root {
      --bg: #0b1220;
      --panel: rgba(19, 31, 48, .8);
      --line: rgba(138, 157, 184, .28);
      --text: #eef3fa;
      --muted: #9fb0c5;
      --sky: #7ea7d8;
      --mint: #65cdb3;
      --warn: #ffd37a;
      --danger: #ff9b9b;
      --glow: 0 18px 45px rgba(9, 14, 24, .28);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      color: var(--text);
      font-family: "Space Grotesk", sans-serif;
      background:
        radial-gradient(circle at 8% 10%, rgba(126, 167, 216, .14), transparent 38%),
        radial-gradient(circle at 90% 14%, rgba(101, 205, 179, .09), transparent 34%),
        linear-gradient(165deg, #0a1220 0%, #101c2e 56%, #0d1829 100%);
    }
    .predict-nav {
      width: min(1160px, 92vw);
      margin: 22px auto 0;
      padding: 11px 16px;
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(11, 18, 32, .72);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }
    .nav-logo {
      text-decoration: none;
      color: var(--text);
      font-family: "Chakra Petch", sans-serif;
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: .03em;
    }
    .nav-logo span { color: var(--mint); }
    .nav-breadcrumb {
      color: var(--muted);
      font-size: .8rem;
      letter-spacing: .1em;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .nav-breadcrumb .current { color: var(--sky); }
    .back-link {
      text-decoration: none;
      color: var(--sky);
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .main {
      width: min(1160px, 92vw);
      margin: 30px auto 28px;
    }
    .page-header {
      margin-bottom: 18px;
    }
    .label {
      color: var(--sky);
      letter-spacing: .15em;
      text-transform: uppercase;
      font-size: .74rem;
      margin-bottom: 8px;
    }
    .page-header h1 {
      margin: 0;
      font-family: "Chakra Petch", sans-serif;
      font-size: clamp(1.9rem, 4vw, 3rem);
      line-height: 1.08;
    }
    .page-header p {
      margin: 10px 0 0;
      color: var(--muted);
      max-width: 700px;
      line-height: 1.6;
    }
    .layout {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 16px;
    }
    .panel {
      border: 1px solid var(--line);
      background: var(--panel);
      border-radius: 18px;
      padding: 18px;
      box-shadow: var(--glow);
    }
    .panel-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-family: "Chakra Petch", sans-serif;
      font-size: 1.1rem;
      margin-bottom: 14px;
    }
    .badge {
      font-size: .68rem;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: var(--sky);
      border: 1px solid rgba(126, 167, 216, .45);
      border-radius: 999px;
      padding: 5px 9px;
    }
    .form-group { margin-bottom: 12px; position: relative; }
    label {
      display: inline-block;
      margin-bottom: 6px;
      font-size: .86rem;
      color: #d7e7f7;
    }
    input {
      width: 100%;
      border: 1px solid rgba(157, 195, 235, .34);
      background: rgba(12, 20, 34, .88);
      color: var(--text);
      border-radius: 11px;
      padding: 11px 12px;
      font: inherit;
      transition: border-color .2s ease, box-shadow .2s ease;
    }
    input:focus {
      outline: none;
      border-color: var(--sky);
      box-shadow: 0 0 0 3px rgba(126, 167, 216, .22);
    }
    .input-hint {
      margin-top: 5px;
      font-size: .72rem;
      color: var(--muted);
      letter-spacing: .06em;
      text-transform: uppercase;
    }
    .btn {
      width: 100%;
      border: 0;
      border-radius: 12px;
      padding: 11px 14px;
      font: inherit;
      font-weight: 700;
      color: #032033;
      background: linear-gradient(120deg, var(--sky), #a9bfd8);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      margin-top: 4px;
    }
    .btn-green {
      background: linear-gradient(120deg, var(--mint), #97cfc0);
    }
    .weather-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 14px;
    }
    .weather-card {
      border: 1px solid rgba(138, 157, 184, .3);
      border-radius: 12px;
      background: rgba(14, 24, 39, .74);
      padding: 12px;
    }
    .wc-icon { font-size: 1rem; }
    .wc-label {
      font-size: .72rem;
      letter-spacing: .08em;
      color: var(--muted);
      text-transform: uppercase;
      margin-top: 3px;
    }
    .wc-value {
      margin-top: 4px;
      color: var(--sky);
      font-family: "Chakra Petch", sans-serif;
      font-size: 1.1rem;
    }
    .note {
      margin: 12px 0 0;
      color: var(--mint);
      font-size: .8rem;
      line-height: 1.45;
    }
    .weather-empty,
    .prediction-empty {
      margin-top: 14px;
      border: 1px dashed rgba(138, 157, 184, .34);
      border-radius: 12px;
      color: var(--muted);
      background: rgba(13, 22, 36, .68);
      min-height: 74px;
      align-items: center;
      justify-content: center;
      gap: 8px;
      text-align: center;
      padding: 12px;
    }
    .icon { font-size: 1.2rem; }
    .prediction-box {
      margin-top: 14px;
      border: 1px solid rgba(101, 205, 179, .38);
      background: linear-gradient(140deg, rgba(17, 31, 42, .86), rgba(13, 23, 36, .85));
      border-radius: 14px;
      padding: 14px;
      align-items: center;
      gap: 12px;
    }
    .pred-icon { font-size: 1.3rem; }
    .pred-label {
      font-size: .72rem;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: var(--muted);
    }
    .pred-value {
      margin-top: 3px;
      font-family: "Chakra Petch", sans-serif;
      font-size: clamp(1.25rem, 2.2vw, 1.75rem);
      color: var(--mint);
    }
    .pred-unit {
      font-size: .85rem;
      color: var(--sky);
      margin-left: 5px;
    }
    .result-bar {
      margin-top: 16px;
      border: 1px solid var(--line);
      border-radius: 14px;
      background: rgba(11, 18, 32, .74);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
      padding: 14px;
      flex-wrap: wrap;
    }
    .rb-text {
      font-size: .82rem;
      color: #d5dfea;
      letter-spacing: .04em;
      text-transform: uppercase;
    }
    .rb-sub {
      margin-top: 4px;
      color: var(--muted);
      font-size: .8rem;
      line-height: 1.5;
    }
    .rb-cta {
      text-decoration: none;
      color: var(--sky);
      font-weight: 700;
      white-space: nowrap;
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 960px) {
      .layout { grid-template-columns: 1fr; }
      .predict-nav { border-radius: 16px; }
    }
    @media (max-width: 560px) {
      .weather-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<nav class="predict-nav">
  <a class="nav-logo" href="/">Wind<span>Force
  </span></a>
  <div class="nav-breadcrumb">
    <span>Home</span>
    <span class="sep">/</span>
    <span class="current">Predict</span>
  </div>
  <a class="back-link" href="/">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M19 12H5M12 19l-7-7 7-7"/>
    </svg>
    Back
  </a>
</nav>

<main class="main">

  <div class="page-header">
    <div class="label">Prediction Engine</div>
    <h1>Energy Output<br>Forecast</h1>
    <p>Fetch live weather for your city, or enter values manually to run the model.</p>
  </div>

  <div class="layout">

    <div class="panel">
      <div class="panel-title">
        Weather Fetch
        <span class="badge">Step 01</span>
      </div>

      <form action="/windapi" method="POST">
        <div class="form-group">
          <label for="city">City name</label>
          <input type="text" id="city" name="city" placeholder="e.g. Copenhagen, Berlin, Chicago" required/>
        </div>
        <button type="submit" class="btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
          </svg>
          Fetch Weather Data
        </button>
      </form>

      <div class="weather-result" style="display: {{ 'block' if temp is defined and temp else 'none' }}">
        <div class="weather-grid">
          <div class="weather-card">
            <div class="wc-icon">Temperature</div>
            <div class="wc-label">Current</div>
            <div class="wc-value">{{ temp if temp is defined else '-' }}</div>
          </div>
          <div class="weather-card">
            <div class="wc-icon">Humidity</div>
            <div class="wc-label">Relative</div>
            <div class="wc-value">{{ humid if humid is defined else '-' }}</div>
          </div>
          <div class="weather-card">
            <div class="wc-icon">Pressure</div>
            <div class="wc-label">Atmospheric</div>
            <div class="wc-value">{{ pressure if pressure is defined else '-' }}</div>
          </div>
          <div class="weather-card">
            <div class="wc-icon">Wind Speed</div>
            <div class="wc-label">Measured</div>
            <div class="wc-value">{{ speed if speed is defined else '-' }}</div>
          </div>
        </div>
        <p class="note">
          Weather data loaded. Copy these values into the manual predictor on the right to generate an energy forecast.
        </p>
      </div>

      <div class="weather-empty" style="display: {{ 'none' if temp is defined and temp else 'flex' }}">
        <div class="icon">Live weather panel is ready</div>
      </div>
    </div>

    <div class="panel">
      <div class="panel-title">
        Manual Predictor
        <span class="badge">Step 02</span>
      </div>

      <form action="/y_predict" method="POST" id="predict-form">
        <div class="form-group">
          <label for="theoretical_power">Theoretical Power</label>
          <input type="number" id="theoretical_power" name="theoretical_power"
                 step="0.01" placeholder="e.g. 1250.00"
                 required/>
          <div class="input-hint">kWh</div>
        </div>

        <div class="form-group">
          <label for="wind_speed">Wind Speed</label>
          <input type="number" id="wind_speed" name="wind_speed"
                 step="0.01" placeholder="e.g. 8.3"
                 value="{{ speed | replace(' m/s','') if speed is defined and speed else '' }}"
                 required/>
          <div class="input-hint">meters / second</div>
        </div>

        <button type="submit" class="btn btn-green">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <polyline points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
          </svg>
          Run Energy Prediction
        </button>
      </form>

      <div class="prediction-box" style="display: {{ 'flex' if prediction_text is defined and prediction_text else 'none' }}">
        <div class="pred-icon">Output</div>
        <div>
          <div class="pred-label">Predicted Output</div>
          <div class="pred-value" id="pred-display">
            {% if prediction_text is defined and prediction_text %}
              {{ prediction_text | replace('The energy predicted is ', '') | replace(' KWh', '') }}
              <span class="pred-unit">kWh</span>
            {% else %}-{% endif %}
          </div>
          {% if prediction_text is defined and prediction_text %}
          <div style="color: var(--muted); font-size:.72rem; margin-top:8px; letter-spacing:.1em; text-transform: uppercase;">
            Estimated energy generation
          </div>
          {% endif %}
        </div>
      </div>

      <div class="prediction-empty" style="display: {{ 'none' if prediction_text is defined and prediction_text else 'flex' }}">
        <div>Submit values to see prediction</div>
      </div>
    </div>

  </div>

  <div class="result-bar">
    <div>
      <div class="rb-text">Model: Random Forest Regressor | Input: Theoretical Power and Wind Speed</div>
      <div class="rb-sub">Predictions are estimates. Real-world output varies by turbine model, terrain, and grid conditions.</div>
    </div>
    <a class="rb-cta" href="/">Back to overview</a>
  </div>

</main>

<script>
  document.querySelectorAll('.form-group').forEach((el, i) => {
    el.style.animation = `fadeUp .5s ${.1 + i * .07}s both`;
  });

  document.querySelectorAll('input').forEach(inp => {
    inp.addEventListener('focus', () => {
      inp.parentElement.querySelector('label').style.color = 'var(--sky)';
    });
    inp.addEventListener('blur', () => {
      inp.parentElement.querySelector('label').style.color = '';
    });
  });

  document.querySelectorAll('form').forEach(form => {
    form.addEventListener('submit', function() {
      const btn = this.querySelector('button[type=submit]');
      btn.style.opacity = '.75';
      btn.textContent = 'Processing...';
    });
  });
</script>
</body>
</html>
